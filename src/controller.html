<!DOCTYPE html>
<html>
<head>
<title>AutoCar V2 Inteface</title>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
<style>
body {
    background-color: #121212;
    color: #f0ece2;
}

p {
    color: lightgray;
    font-family: Arial, Helvetica, sans-serif;
    font-size: 15px;
}

.indicators {
	display: flex;
}

.indicator {
    border-radius: 12px;
	border: solid lightgray 2px;
	height: 520px;
	width: 180px;	
	margin: 5px;
}


</style>
</head>
<body>
<div class="indicators">
	<div class="indicator">
		<div style="text-align: center;">
			<p style="font-size: 26px; font-weight: bold; margin:auto; margin-top:20px; width: 90%;">Left Motor</p>
		</div>
        <div style="text-align:center;">
            <p style="margin:0px; font-size: 20px;">Actual Speed:</p>
            <p style="margin:0px; font-size: 20px;" id="indicator_motorleft_actspeed">10.0 cm/s</p>
        </div>
		<div style="display: flex; text-align:center; height: 10%;">
			<div style="width:50%; margin: auto; border: solid gray 3px;">
				<p style="margin:0px;">Setpoint:</p>
				<p style="margin:0px;" id="indicator_motorleft_setpoint">10.0 cm/s</p>
			</div>
			<div style="width:50%; margin: auto; border: solid gray 3px;">
				<p style="margin:0px;">Throttle:</p>
				<p style="margin:0px;" id="indicator_motorleft_throttle">100%</p>
			</div>
		</div>
		<div>
			<div style="margin:auto; width: 80%;">
				<label>Setpoint</label>
				<input type="text" id="input_motorleft_setpoint" style="width: 40px; text-align: center;"> cm/s
				<label>Throttle</label>
				<input type="text" id="input_motorleft_throttle"style="width: 40px; text-align: center; margin-left: 1.5px;"> %  
			</div>
			<div style="margin:auto; width: 50%;">
				<label>Kp</label>
				<input type="text" id="input_motorleft_kp" style="width: 40px; text-align: center; margin-left: 6.5px;">
				<label>Ki	</label>
				<input type="text" id="input_motorleft_ki" style="width: 40px; text-align: center; margin-left: 10px;">
				<label>Kd</label>
				<input type="text" id="input_motorleft_kd" style="width: 40px; text-align: center; margin-left: 6.5px;"> 
				<button style="width: 100%;" id="input_motorleft_sendbutton">send</button>
			</div>
			<div style="text-align:center">
				<p style="margin:0px" id="indicator_motorleft_ki">Kp: 0.00</p>
				<p style="margin:0px" id="indicator_motorleft_kp">Ki: 0.00</p>
				<p style="margin:0px" id="indicator_motorleft_kd">Kd: 0.00</p>
			</div>
		</div>
		<div  style="display: flex;">
			<button style="width: 45%; height: 50px; margin: auto;" id="input_motorleft_closedloop_button">CLOSED LOOP</button>
            <button style="width: 45%; height: 50px; margin: auto;" id="input_motorleft_openloop_button">OPEN LOOP</button>
		</div>
		
	</div>
	<div class="indicator">
		<div style="text-align: center;">
			<p style="font-size: 26px; font-weight: bold; margin:auto; margin-top:20px; width: 95%;">Right Motor</p>
		</div>
        <div style="text-align:center;">
            <p style="margin:0px; font-size: 20px;">Actual Speed:</p>
            <p style="margin:0px; font-size: 20px;" id="indicator_motorright_actspeed">10.0 cm/s</p>
        </div>
		<div style="display: flex; text-align:center; height: 10%;">
			<div style="width:50%; margin: auto; border: solid gray 3px;">
				<p style="margin:0px;">Setpoint:</p>
				<p style="margin:0px;" id="indicator_motorright_setpoint">10.0 cm/s</p>
			</div>
			<div style="width:50%; margin: auto; border: solid gray 3px;">
				<p style="margin:0px;">Throttle:</p>
				<p style="margin:0px;" id="indicator_motorright_throttle">100%</p>
			</div>
		</div>
		<div>
			<div style="margin:auto; width: 80%;">
				<label>Setpoint</label>
				<input type="text" id="input_motorright_setpoint" style="width: 40px; text-align: center;"> cm/s
				<label>Throttle</label>
				<input type="text" id="input_motorright_throttle" style="width: 40px; text-align: center; margin-left: 1.5px;"> %  
			</div>
			<div style="margin:auto; width: 50%;">
				<label>Kp</label>
				<input type="text" id="input_motorright_kp" style="width: 40px; text-align: center; margin-left: 6.5px;">
				<label>Ki	</label>
				<input type="text" id="input_motorright_ki" style="width: 40px; text-align: center; margin-left: 10px;">
				<label>Kd</label>
				<input type="text" id="input_motorright_kd" style="width: 40px; text-align: center; margin-left: 6.5px;"> 
				<button style="width: 100%;">send</button>
			</div>
			<div style="text-align:center">
				<p id="indicator_motorright_kp"style="margin:0px">Kp: 0.00</p>
				<p id="indicator_motorright_ki"style="margin:0px">Ki: 0.00</p>
				<p id="indicator_motorright_kd"style="margin:0px">Kd: 0.00</p>
			</div>
		</div>
		<div  style="display: flex;">
			<button  id="input_motorleft_closedloop_button" style="width: 45%; height: 50px; margin: auto;">CLOSED LOOP</button>
			<button  id="input_motorleft_openloop_button" style="width: 45%; height: 50px; margin: auto;">OPEN LOOP</button>
		</div>
		
	</div>
	<div class="indicator">
		<div style="text-align: center;">
			<p style="font-size: 26px; font-weight: bold; margin:auto; margin-top:20px; width: 90%;">Ultrassounds</p>
		</div>
		<div>
			<p id="indicator_ultrassound_front" style="margin:0px; margin-left: 5px;">Front: 000 cm</p>
			<p id="indicator_ultrassound_front_left" style="margin:0px; margin-left: 5px;">Front Left: 000 cm</p>
			<p id="indicator_ultrassound_front_right" style="margin:0px; margin-left: 5px;">Front Right: 000 cm</p>
			<p id="indicator_ultrassound_left" style="margin:0px; margin-left: 5px;">Left: 000 cm</p>
			<p id="indicator_ultrassound_right" style="margin:0px; margin-left: 5px;">Right: 000 cm</p>
			<p id="indicator_ultrassound_back" style="margin:0px; margin-left: 5px;">Back: 000 cm</p>
			<p id="indicator_ultrassound_back_left" style="margin:0px; margin-left: 5px;">Back Left: 000 cm</p>
			<p id="indicator_ultrassound_back_right" style="margin:0px; margin-left: 5px;">Back Right: 000 cm</p>
		</div>
		<div style="text-align: center;">
			<p style="font-size: 26px; font-weight: bold; margin:auto; width: 90%;">Car Control</p>
		</div>
		<div style="display: flex;">
			<button id="input_carmode_auto" style="width: 45%; height: 50px; margin: auto;">AUTO</button>
			<button id="input_carmode_manual" style="width: 45%; height: 50px; margin: auto;">MANUAL</button>
		</div>
        <div style="text-align: center;">
			<p style="font-size: 26px; font-weight: bold; margin:auto; width: 90%;">Inertial Unit</p>
		</div>
        <div>
			<p id="indicator_imu_accelx" style="margin:0px; margin-left: 5px;">AccelX: 0.00 m/s²</p>
			<p id="indicator_imu_accely" style="margin:0px; margin-left: 5px;">AccelY: 0.00 m/s²</p>
			<p id="indicator_imu_accelz" style="margin:0px; margin-left: 5px;">AccelZ: 0.00 m/s²</p>
			<p id="indicator_imu_gyrox" style="margin:0px; margin-left: 5px;">GyroX: 0.00 rad/s</p>
			<p id="indicator_imu_gyroy" style="margin:0px; margin-left: 5px;">GyroY: 0.00 rad/s</p>
			<p id="indicator_imu_gyroz" style="margin:0px; margin-left: 5px;">GyroZ: 0.00 rad/s</p>
			<p id="indicator_imu_pitch" style="margin:0px; margin-left: 5px;">Pitch: 0.00 deg</p>
			<p id="indicator_imu_roll" style="margin:0px; margin-left: 5px;">Roll: 0.00 deg</p>
            <p id="indicator_imu_heading" style="margin:0px; margin-left: 5px;">Heading: 360 deg</p>
            <p id="indicator_imu_temperature" style="margin:0px; margin-left: 5px;">Temperature: 25°C</p>
            <p id="indicator_imu_pressure" style="margin:0px; margin-left: 5px;">Pressure: 1060 mmHg</p>
		</div>
	</div>
    <div class="indicator">
        <div style="text-align: center;">
            <p style="font-size: 26px; font-weight: bold; margin:auto; margin-top:20px; width: 90%;">Random Info</p>
        </div>
        <div style="text-align:center;">
            <p id="indicator_battery_voltage" style="margin: 5px;">Battery: 11.1 V</p>
            <p id="indicator_latency"style="margin: 5px;">Latency: 100 ms</p>
            <p style="margin: 5px; margin-bottom:0px">Update Frequency:</p>
            <p id="indicator_update_frequency" style="margin: 5px; margin-top:0px">10.0 Hz</p>
            
            
        </div>
    </div>
</div>
</body>
<script>
	
	// Configuração de WebSocket

	
	var gateway = `ws://${window.location.hostname}/ws`;
	var websocket;	
	// Init web socket when the page loads
	window.addEventListener('load', onload);

	function onload(event) {
	    initWebSocket();
	}
	
	function initWebSocket() {
	    console.log('Trying to open a WebSocket connection…');
	    websocket = new WebSocket(gateway);
	    websocket.onopen = onOpen;
	    websocket.onclose = onClose;
	    websocket.onmessage = onMessage;
	}

	// When websocket is established, call the getReadings() function
	function onOpen(event) {
	    console.log('Connection opened');
	}

	function onClose(event) {
	    console.log('Connection closed');
	    setTimeout(initWebSocket, 2000);
	}

	// Function that receives the message from the ESP32 with the readings
	function onMessage(event) {
		var data = JSON.parse(event.data);
		updateIndicators(data);
	}
	
	
	
	// ---------------------------------------------------------------------
	// Função de atualização de todos os indicadores após receber uma mensagem
	// ---------------------------------------------------------------------
	
	function updateIndicators(data){
        
	}
	
	
</script>
</html>


